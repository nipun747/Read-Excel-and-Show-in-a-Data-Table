<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Read Excel and Show in a Table</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h2 class="text-center mt-4 mb4">Read Excel and Show in a Table</h2>
        <div class="card">
            <div class="card-header">Select Excel file</div>
            <div class="card-body">
                <input type="file" id="excel_file" onchange="filevalidation()"/>
            </div>
        </div>
    </div>

    <div id="excel_data" class="mt-5"></div>
    <div id="size" class="mt-5"></div>

    
</body>
<script>
    filevalidation=()=>{
        let fi=document.getElementById("excel_file");
        if(fi.files.length>0){
            for (let i=0;i<=fi.files.length-1;i++){
                const fileSize=fi.files[i].size/1024
                if (fileSize>=4*1024) alert ("File too big,Please select a file less than 4mb");
                else if(fileSize<2)alert("File too small");
                else{
                    const file = fi.files[0];
                    document.getElementById("size").innerHTML="<b>"+fileSize+"</b> +KB"
                    if(
                        !["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(
                            file.type
                        )
                    ){
                        document.getElementById("excel_data").innerHTML=
                        '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';
                        fi.value="";
                        return false;
                    }
                    var reader =new FileReader();
                    reader.readAsArrayBuffer(file);
                    reader.onload=function(event){
                        var data=new Uint8Array(reader.result);

                        var work_book=XLSX.read(data,{type:"array"});

                        var sheet_name=work_book.SheetNames;

                        var sheet_data =XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]],{header:1});

                        if (sheet_data.length>0){
                            var table_output='<table class="table table-striped table-bordered">';

                            for(var row=0;row<sheet_data.length;row++){
                                table_output +="<tr>";
                                for(var cell=0;cell<sheet_data[row].length;cell++){
                                    if (row==0){
                                        table_output += "<th>" +sheet_data[row][cell]+"</th>";
                                    }
                                    else{
                                        table_output +="<td>"+sheet_data[row][cell]+"</td>"
                                    }
                                }
                                table_output +="</tr>";
        
                            }
                            table_output +="</table>";
                            document.getElementById("excel_data").innerHTML=table_output;
                        }
                        fi.value="";
                    }

                }
            }
        }
    }
</script>
</html>